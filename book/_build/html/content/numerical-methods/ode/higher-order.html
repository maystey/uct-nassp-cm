
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Solving Coupled and Higher Order ODEs &#8212; AST4007W Computational Methods</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/worked_example_div.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Runge-Kutta Methods" href="runge-kutta.html" />
    <link rel="prev" title="Eulerâ€™s Method: Truncation Error" href="euler-error.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
      <img src="../../../_static/UCTcircular_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">AST4007W Computational Methods</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   UCT NASSP AST4007W Computational Methods
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro/intro.html">
   Programming and Python in a Nutshell
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro/control-flow/control-flow-diagrams.html">
   Control Flow Diagrams
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  The Python Standard Library
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../standard-library/basics/intro.html">
   Python Basics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/basics/variables.html">
     Variables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/basics/comments.html">
     Comments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/basics/types.html">
     Type Conversion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/basics/operators.html">
     Numerical Operators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/basics/assignment-operators.html">
     Compound Assignment Operators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/basics/functions.html">
     Introduction to Using Functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../standard-library/strings/strings.html">
   Strings
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/strings/string-formatting.html">
     String Formatting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../standard-library/data-structures/intro.html">
   Data Structures
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/data-structures/tuple.html">
     Tuple
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/data-structures/lists.html">
     Lists
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/data-structures/dictionaries.html">
     Dictionaries
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../standard-library/if-statements/intro.html">
   If Statements
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/if-statements/bools.html">
     Booleans (
     <code class="docutils literal notranslate">
      <span class="pre">
       bool
      </span>
     </code>
     )
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/if-statements/comparison-operators.html">
     Comparison Operators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/if-statements/logical-operators.html">
     Logical Operators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/if-statements/inclusion-operators.html">
     Inclusion Operators
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/if-statements/if.html">
     If Statements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/if-statements/nested.html">
     Nested If Statements
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../standard-library/loops/intro.html">
   Loops
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/loops/while.html">
     While Loops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/loops/for.html">
     For Loops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/loops/nested.html">
     Nested Loops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/loops/break.html">
     Breaking Out of Loops
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/loops/else.html">
     Else Statement and Loops
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../standard-library/functions/intro.html">
   Defining Functions
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/functions/return.html">
     <code class="docutils literal notranslate">
      <span class="pre">
       return
      </span>
     </code>
     Statement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/functions/arguments.html">
     Function Arguments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/functions/local-variables.html">
     Local Variables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/functions/recursive.html">
     Recursive Functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../standard-library/file-io/intro.html">
   File I/O
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/file-io/file-io.html">
     File I/O
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../standard-library/file-io/data.html">
     Structured Data Files
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Scientific Packages
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../scientific-packages/numpy/intro.html">
   Numpy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../scientific-packages/numpy/arrays.html">
     Arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../scientific-packages/numpy/array-methods.html">
     Array Methods and Attributes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../scientific-packages/numpy/arrays2d.html">
     2D Arrays and Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../scientific-packages/numpy/random.html">
     NumPy Random Module
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../scientific-packages/numpy/where.html">
     Array Conditional Statements and
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy.where()
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../scientific-packages/matplotlib/intro.html">
   Matplotlib
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../scientific-packages/matplotlib/simple.html">
     Simple Plots with Pyplot
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../scientific-packages/matplotlib/subplots.html">
     Subplots
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../scientific-packages/astropy/intro.html">
   Astropy
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../scientific-packages/astropy/units.html">
     Units and Quantities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../scientific-packages/astropy/constants.html">
     Constants
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Numerical Methods
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../root-finding/intro.html">
   Numerical Root Finding
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../root-finding/bisection.html">
     Bisection Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../root-finding/secant.html">
     Secant Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../root-finding/newton.html">
     Newton-Raphson Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../root-finding/comparison.html">
     Comparing the Methods
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../regression/intro.html">
   Linear Regression Algorithms
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../regression/notation.html">
     Statistical Notation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../regression/least-squares.html">
     Linear Least Squares Minimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../regression/chi-squared.html">
     Chi Squared Minimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../regression/multivariate-least-squares.html">
     Multivariate Linear Least Squares Minimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../regression/scipy.html">
     Least Squares Minimization with
     <code class="docutils literal notranslate">
      <span class="pre">
       scipy.optimize.leastsq
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   Numerical Solutions to Ordinary Differential Equations
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="euler.html">
     Eulerâ€™s Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="euler-error.html">
     Eulerâ€™s Method: Truncation Error
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Solving Coupled and Higher Order ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="runge-kutta.html">
     Runge-Kutta Methods
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../integration/intro.html">
   Numerical Integration Techniques
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../integration/midpoint.html">
     Midpoint Rule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../integration/trapezoidal.html">
     Trapezoidal Rule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../integration/simpson.html">
     Simpsonâ€™s Rule
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../../_sources/content/numerical-methods/ode/higher-order.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/maystey/uct-nassp-cm-2021"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/maystey/uct-nassp-cm-2021/issues/new?title=Issue%20on%20page%20%2Fcontent/numerical-methods/ode/higher-order.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/maystey/uct-nassp-cm-2021/master?urlpath=tree/book/content/numerical-methods/ode/higher-order.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#coupled-ordinary-differential-equations">
   Coupled Ordinary Differential Equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#arbitrarily-many-coupled-ordinary-differential-equations">
     Arbitrarily Many Coupled Ordinary Differential Equations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#second-order-differential-equations">
   Second Order Differential Equations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#higher-order-differential-equations">
   Higher Order Differential Equations
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="solving-coupled-and-higher-order-odes">
<h1>Solving Coupled and Higher Order ODEs<a class="headerlink" href="#solving-coupled-and-higher-order-odes" title="Permalink to this headline">Â¶</a></h1>
<p>A common way to solve higher order ODEs using numerical methods is to convert this to a system of first order ODEs. We will first look at solving systems of coupled first order diffrential equations, and then we will focus on reducing higher order ODEs to solve them in a similar manner.</p>
<div class="section" id="coupled-ordinary-differential-equations">
<h2>Coupled Ordinary Differential Equations<a class="headerlink" href="#coupled-ordinary-differential-equations" title="Permalink to this headline">Â¶</a></h2>
<p>Consider a system of first order coupled ODEs in the form:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{d x}{dt}(t) &amp;= f\big(t, x(t), y(t)\big)\\
\frac{d y}{dt}(t) &amp;= g\big(t, x(t), y(t)\big)
\end{align*}\]</div>
<p>given the initial conditions:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
x(t_0) &amp;= x_0\\
y(t_0) &amp;= y_0
\end{align*}\]</div>
<p>where there is one independent variable <span class="math notranslate nohighlight">\(t\)</span>, and two dependent variables <span class="math notranslate nohighlight">\(x(t)\)</span> and <span class="math notranslate nohighlight">\(y(t)\)</span>.</p>
<p>Note that we cannot simply solve the ODEs for <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> independently, as the ODE functions contain both of these variables. Instead, for our numerical solution, we must solve them simultaneously, step-by-step. Applying Eulerâ€™s method, defining <span class="math notranslate nohighlight">\(t_{n + 1} = t_n + h\)</span>, <span class="math notranslate nohighlight">\(x_n = x(t_n)\)</span> and <span class="math notranslate nohighlight">\(y_n = y(t_n)\)</span>, the update step is:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
x_{n+1} &amp;= x_{n} + f(t_n, x_n, y_n)\\
y_{n+1} &amp;= y_{n} + g(t_n, x_n, y_n)\\
\end{align*}\]</div>
<p>As you can see, in order to calculate <span class="math notranslate nohighlight">\(x_{n+1}\)</span>, you need to know both the values of <span class="math notranslate nohighlight">\(x_n\)</span> and <span class="math notranslate nohighlight">\(y_n\)</span> (the same goes for <span class="math notranslate nohighlight">\(y_{n+1}\)</span>).</p>
<div class="worked-example">
    <h5 class="worked-example-title"><b>Worked Example</b></h5><p>Consider the coupled system of first order ODEs: <!-- Find something less arbitrary, or at least verifiable through analytic/intuitive means--></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{d x}{dt} &amp;= t  +x y\\
\frac{d y}{dt} &amp;= t - x
\end{align*}\]</div>
<p>with the initial conditions</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
x(0) &amp;= 0\\
y(0) &amp;= 1
\end{align*}\]</div>
<p>Letâ€™s write a script to integrate these ODEs using Eulerâ€™s method to find <span class="math notranslate nohighlight">\(x(t)\)</span> and <span class="math notranslate nohighlight">\(y(t)\)</span> up to <span class="math notranslate nohighlight">\(t = 10\)</span>. Weâ€™ll store the values in an array and plot them at the end.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">t0</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="c1">#initial conditions</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="c1">#step size</span>
<span class="n">t_end</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1">#last time step</span>


<span class="c1">#The ODE functions</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">t</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">t</span> <span class="o">-</span> <span class="n">x</span>


<span class="c1">#Constructing the arrays:</span>
<span class="n">t_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t_end</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="c1">#make sure it goes up to and including t_end</span>

<span class="n">x_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">t_arr</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">y_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">t_arr</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>


<span class="c1">#Setting the initial conditions</span>
<span class="n">x_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
<span class="n">y_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>


<span class="c1">#Performing the Euler method, note we don&#39;t use the last t values in the update calculations</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">x_arr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y_arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">y_arr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">g</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y_arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>


<span class="c1">##Plotting both curves</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_arr</span><span class="p">,</span> <span class="n">x_arr</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x(t)&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_arr</span><span class="p">,</span> <span class="n">y_arr</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y(t)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/higher-order_6_0.png" src="../../../_images/higher-order_6_0.png" />
</div>
</div>
</div><div class="section" id="arbitrarily-many-coupled-ordinary-differential-equations">
<h3>Arbitrarily Many Coupled Ordinary Differential Equations<a class="headerlink" href="#arbitrarily-many-coupled-ordinary-differential-equations" title="Permalink to this headline">Â¶</a></h3>
<p>Now, letâ€™s consider a general solution for arbitrarily many coupled ODEs. Consider the system of coupled first order differential equations:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{d x_1}{dt} &amp;= f_1 (t, x_1, x_2, \dots, x_m)\\
\frac{d x_2}{dt} &amp;= f_2 (t, x_1, x_2, \dots, x_m)\\
\frac{d x_3}{dt} &amp;= f_3 (t, x_1, x_2, \dots, x_m)\\
&amp; \vdots\\
\frac{d x_m}{dt} &amp;= f_m (t, x_1, x_2, \dots, x_m)\\
\end{align*}\]</div>
<p>with initial conditions:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
x_1(t_0) &amp;= x_{1\ 0}\\
x_2(t_0) &amp;= x_{2\ 0}\\
x_3(t_0) &amp;= x_{3\ 0}\\
&amp; \vdots\\
x_m(t_0) &amp;= x_{m\ 0}
\end{align*}\]</div>
<p>We can boil down the update step to a single line of code by vectorizing the equations and conditions using NumPy arrays. Letâ€™s define the following vector and vector function:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{x}(t) =
\begin{pmatrix}
x_1 (t)\\
x_2 (t)\\
x_3 (t)\\
\vdots\\
x_m (t)
\end{pmatrix} \quad \text{and} \quad
\vec{f}(\vec{x}) = 
\begin{pmatrix}
f_1 (t, \vec{x})\\
f_2 (t, \vec{x})\\
f_3 (t, \vec{x})\\
\vdots\\
f_m (t, \vec{x})
\end{pmatrix}
\end{split}\]</div>
<p>The system of ODEs can now be written as:</p>
<div class="math notranslate nohighlight">
\[
\frac{d \vec{x}}{dt} = \vec{f}(t, \vec{x})
\]</div>
<p>Using our usual definitions of <span class="math notranslate nohighlight">\(t_{n+1} = t_n + h\)</span> and <span class="math notranslate nohighlight">\(\vec{x}(t_n) = \vec{x}_n\)</span>, the Euler update step can be written as:</p>
<div class="math notranslate nohighlight">
\[
\vec{x}_{n+1} = \vec{x}_n + h  \vec{f}(t_n, \vec{x}_n)
\]</div>
<div class="worked-example">
    <h5 class="worked-example-title"><b>Worked Example</b></h5><p>Consider the system of 3 first order coupled ODEs:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{d x}{dt} &amp;= t  +x y\\
\frac{d y}{dt} &amp;= t - x\\
\frac{d z}{dt} &amp;= y
\end{align*}\]</div>
<p>with the initial conditions</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
x(0) &amp;= 0\\
y(0) &amp;= 1\\
z(0) &amp;= 0
\end{align*}\]</div>
<p>Letâ€™s adapt the previous script to integrate these coupled ODEs using Eulerâ€™s method, this time making use of NumPy arrayâ€™s vectorized operations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">t0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="c1">#initial conditions</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="c1">#step size</span>
<span class="n">t_end</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1">#last time step</span>


<span class="c1">#The ODE function</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="n">t</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">t</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">])</span>


<span class="c1">#Constructing the arrays:</span>
<span class="n">t_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t_end</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="c1">#make sure it goes up to and including t_end</span>

<span class="n">x_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">t_arr</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">x0</span><span class="o">.</span><span class="n">size</span><span class="p">))</span> <span class="c1">#a 2D array, first dimension for t steps, second for the different x_i</span>


<span class="c1">#Setting the initial conditions</span>
<span class="n">x_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">x0</span>


<span class="c1">#Performing the Euler method</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">x_arr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">x_arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>


<span class="c1">##Plotting all of the curves</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">x0</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">x0</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x0</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_arr</span><span class="p">,</span> <span class="n">x_arr</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">fr</span><span class="s1">&#39;$x_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">(t)$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/higher-order_12_0.png" src="../../../_images/higher-order_12_0.png" />
</div>
</div>
<!-- Show a script where a function is used? --></div></div>
</div>
<div class="section" id="second-order-differential-equations">
<h2>Second Order Differential Equations<a class="headerlink" href="#second-order-differential-equations" title="Permalink to this headline">Â¶</a></h2>
<p>In general, if we wish to solve an ODE of the form</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2y}{dx^2} = f\left(x, y, \frac{dy}{dx}\right)
\]</div>
<!--- Problem with notation!!!!!!!!!! --->
<p>with initial conditions <span class="math notranslate nohighlight">\(y(x = x_0) = y_0\)</span> and <span class="math notranslate nohighlight">\(y^\prime(x = x_0) = y^\prime_0\)</span> ,
we can transform these into a system of coupled first order equations by introducing the variable:</p>
<div class="math notranslate nohighlight">
\[
v = \frac{dy}{dx}
\]</div>
<p>which gives us the equations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\frac{dy}{dx} &amp;= v\\
\frac{dv}{dx} &amp;= f(x, y, v)\\
\end{align*}
\end{split}\]</div>
<p>with the initial conditions</p>
<p>As the ODE for <span class="math notranslate nohighlight">\(y\)</span> depends on <span class="math notranslate nohighlight">\(v\)</span> and the ODE for <span class="math notranslate nohighlight">\(v\)</span> depends on <span class="math notranslate nohighlight">\(y\)</span>, these equations need to be integrated simultaneously.</p>
<div class="worked-example">
    <h5 class="worked-example-title"><b>Worked Example</b></h5><p>Consider second order ODE:</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2 y}{dt^2} + 10 \frac{dy}{dt} + 100y = 100 |\sin(t)|
\]</div>
<p>which we wish to solve for the initial conditions <span class="math notranslate nohighlight">\(y = 0.1\)</span>, <span class="math notranslate nohighlight">\(dy/dx = -0.5\)</span> at <span class="math notranslate nohighlight">\(t = 0\)</span>.</p>
<p>Firstly letâ€™s rearrange the equation to make <span class="math notranslate nohighlight">\(y^{\prime\prime}\)</span> the subject:</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2 y}{dt^2} = 100 |\sin(t)| - 10 \frac{dy}{dt} - 100 y
\]</div>
<p>We start by introducing the variables:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
y_0 &amp;= y\\
y_1 &amp;= \frac{dy}{dt} = \frac{d y_0}{dt}\\
\end{align*}\]</div>
<p>which form the vector:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{y} = \begin{pmatrix} y_0 \\ y_1 \end{pmatrix}
\end{split}\]</div>
<p>in order to reduce the second order ODE to a coupled system of two first order ODEs:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\frac{d y_0}{dt} &amp;= y_1\\
\frac{d y_1}{dt} &amp;= 100|sin(t)| - 10 y_1 - 100 y_0
\end{align*}
\end{split}\]</div>
<p>which can be vectorized as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\frac{d \vec{y}}{dt} =
\begin{pmatrix}
y_1\\
100|sin(t)| - 10 y_1 - 100 y_0
\end{pmatrix}
\end{split}\]</div>
<p>This can be solved by modifying our solutions from the previous worked example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">t0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">])</span> <span class="c1">#initial conditions</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="c1">#step size</span>
<span class="n">t_end</span> <span class="o">=</span> <span class="mi">10</span>


<span class="c1">#The ODE function</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">])</span>


<span class="c1">#Constructing the arrays:</span>
<span class="n">t_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t_end</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="c1">#make sure it goes up to and including x_end</span>

<span class="n">y_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">t_arr</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">y0</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>


<span class="c1">#Setting the initial conditions</span>
<span class="n">y_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">y0</span>


<span class="c1">#Performing the Euler method, note we don&#39;t use the last x value in the update calculations</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">t_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">y_arr</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">y_arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>
    
     
<span class="c1">##Plotting both curves</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_arr</span><span class="p">,</span> <span class="n">y_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y(t)&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_arr</span><span class="p">,</span> <span class="n">y_arr</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y&#39;(t)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/higher-order_19_0.png" src="../../../_images/higher-order_19_0.png" />
</div>
</div>
<p>In the solution above we used separate variables to store the values for <span class="math notranslate nohighlight">\(y(x)\)</span> and <span class="math notranslate nohighlight">\(v(x)\)</span>. In the example below, we shall see that it is more practical to store these values in a single 2D array.</p>
</div></div>
<div class="section" id="higher-order-differential-equations">
<h2>Higher Order Differential Equations<a class="headerlink" href="#higher-order-differential-equations" title="Permalink to this headline">Â¶</a></h2>
<p>We can extend this technique of creating a system of coupled first order equations to an ODE of arbitrary order:</p>
<div class="math notranslate nohighlight">
\[
\frac{d^m y}{d x^m} =  f\left(x, \frac{d y}{dx}, \frac{d^2y}{dx^2}, \frac{d^3y}{dx^3}, \dots, \frac{d^{m-1} y}{dx^{m-1}} \right)
\]</div>
<p>with initial conditions</p>
<div class="math notranslate nohighlight">
\[
y(x = x_0) = y_0 ~~~~~~ \frac{dy}{dx}(x = x_0) = y^\prime_0 ~~~~~~ \frac{d^2y}{dx^2}(x = x_0) = y^{\prime\prime}_0 ~~~~~~ \dots ~~~~~~ \frac{d^{n-1}y}{dx^{m-1}}(x = x_0) = y^{(m-1)}_0
\]</div>
<p>We start by introducing the variables:</p>
<div class="math notranslate nohighlight">
\[
y_0 = y ~~~~~~ y_1 = \frac{dy}{dx} ~~~~~~ y_2 = \frac{d^2y}{dx^2} ~~~~~~ \dots ~~~~~ y_{m-1} = \frac{d^{m-1}y}{dx^{m-1}}
\]</div>
<p>we can transform the order <span class="math notranslate nohighlight">\(n\)</span> ODE to a set of <span class="math notranslate nohighlight">\(n\)</span> first order coupled differential equations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\frac{d y_0}{dx} &amp;= y_1\\
\frac{d y_1}{dx} &amp;= y_2\\
\frac{d y_2}{dx} &amp;= y_3\\
                &amp;\vdots\\
\frac{d y_{m-2}}{dx} &amp;= y_{m-1}\\
\frac{d y_{m-1}}{dx} &amp;= f(x, y_0, y_1, y_2, y_3, \dots, y_{m-2}, y_{m-1})\\
\end{align*}
\end{split}\]</div>
<p>Again, we can vectorize this in order to use a solution similar to those above:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\vec{y} =
\begin{pmatrix}
y_0\\
y_1\\
\vdots\\
y_{m -1}
\end{pmatrix}
\end{split}\]</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python37364bitbaseconda97808f46a65a4f1e9dfdbcff18a07fbf",
            path: "./content/numerical-methods/ode"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python37364bitbaseconda97808f46a65a4f1e9dfdbcff18a07fbf'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="euler-error.html" title="previous page">Eulerâ€™s Method: Truncation Error</a>
    <a class='right-next' id="next-link" href="runge-kutta.html" title="next page">Runge-Kutta Methods</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Luis A. Balona, Ed Elson, Masimba Paradza and Mayhew Steyn<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>